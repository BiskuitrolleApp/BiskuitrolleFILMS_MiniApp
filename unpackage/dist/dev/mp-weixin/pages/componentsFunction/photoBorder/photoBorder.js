(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/componentsFunction/photoBorder/photoBorder"],{145:function(e,t,o){"use strict";(function(e){o(5);n(o(3));var t=n(o(146));function n(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=o,e(t.default)}).call(this,o(1)["createPage"])},146:function(e,t,o){"use strict";o.r(t);var n=o(147),i=o(149);for(var a in i)"default"!==a&&function(e){o.d(t,e,(function(){return i[e]}))}(a);o(156);var r,c=o(11),s=Object(c["default"])(i["default"],n["render"],n["staticRenderFns"],!1,null,"35a066a5",null,!1,n["components"],r);s.options.__file="pages/componentsFunction/photoBorder/photoBorder.vue",t["default"]=s.exports},147:function(e,t,o){"use strict";o.r(t);var n=o(148);o.d(t,"render",(function(){return n["render"]})),o.d(t,"staticRenderFns",(function(){return n["staticRenderFns"]})),o.d(t,"recyclableRender",(function(){return n["recyclableRender"]})),o.d(t,"components",(function(){return n["components"]}))},148:function(e,t,o){"use strict";var n;o.r(t),o.d(t,"render",(function(){return i})),o.d(t,"staticRenderFns",(function(){return r})),o.d(t,"recyclableRender",(function(){return a})),o.d(t,"components",(function(){return n}));try{n={uNoticeBar:function(){return Promise.all([o.e("common/vendor"),o.e("uni_modules/uview-ui/components/u-notice-bar/u-notice-bar")]).then(o.bind(null,356))},uButton:function(){return Promise.all([o.e("common/vendor"),o.e("uni_modules/uview-ui/components/u-button/u-button")]).then(o.bind(null,166))},uPopup:function(){return Promise.all([o.e("common/vendor"),o.e("uni_modules/uview-ui/components/u-popup/u-popup")]).then(o.bind(null,176))}}}catch(c){if(-1===c.message.indexOf("Cannot find module")||-1===c.message.indexOf(".vue"))throw c;console.error(c.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var i=function(){var e=this,t=e.$createElement;e._self._c},a=!1,r=[];i._withStripped=!0},149:function(e,t,o){"use strict";o.r(t);var n=o(150),i=o.n(n);for(var a in n)"default"!==a&&function(e){o.d(t,e,(function(){return n[e]}))}(a);t["default"]=i.a},150:function(e,t,o){"use strict";(function(e,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=l(o(36)),a=o(153),r=l(o(154)),c=o(13),s=(o(155),l(o(138)));function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t,o,n,i,a,r){try{var c=e[a](r),s=c.value}catch(l){return void o(l)}c.done?t(s):Promise.resolve(s).then(n,i)}function f(e){return function(){var t=this,o=arguments;return new Promise((function(n,i){var a=e.apply(t,o);function r(e){u(a,n,i,r,c,"next",e)}function c(e){u(a,n,i,r,c,"throw",e)}r(void 0)}))}}function h(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function g(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?h(Object(o),!0).forEach((function(t){m(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):h(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function m(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var d=function(){o.e("pages/componentsFunction/photoBorder/components/form").then(function(){return resolve(o(184))}.bind(null,o)).catch(o.oe)};e.loadFontFace({global:!0,family:"gilmerRegular",source:'url("https://vkceyugu.cdn.bspapp.com/VKCEYUGU-915d01a8-6118-4e1e-840f-697d960cbba2/fb5d1790-57b8-4ae5-a1ab-f6bf975ea055.otf")',scopes:["webview","native"],success:function(e){console.log("字体加载完成")},fail:function(e){console.log("字体加载失败",e)}});var p={components:{infoForm:d},data:function(){return{systemPlatform:"devtools",systemPlatformText:"ios由于安全会擦除图片信息，无法正常识别图片的参数",showQuality:.01,showForm:!1,saveImgUrl:"",photoConfigData:[],defaultLogo:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-915d01a8-6118-4e1e-840f-697d960cbba2/47e9cb99-42e4-4b8b-8447-c8597ea8b5b2.png",photoExifInfo:{},userInfo:{},photoDrawList:[],tempImage:"",tempImageBase64:"",loading:!1,canvasConfig:{maxCanvasSize:320,maxCanvasInfoWrapperSize:30,scale:1},photoDrawInfo:{width:320,height:240,compress:100,background:"#ffffff",mainImage:{scale:1,customAngle:0,position:"center",content:"",originWidth:100,originHeight:100,width:100,height:100,xAxis:0,yAxis:0,angle:0},EXIFInfo:{InfoWrapperHeight:30,fontStyle:"",fontColor:"#000000",color:"#9f9f9f",fontSize:10,secondFontSize:8,imgInfo:{xAxis:0,yAxis:0,content:"focal, fnumber, exposure, ISO",fontStyle:"",fontColor:"#000000",fontSize:8},machineName:{xAxis:0,yAxis:0,content:"machine name",fontStyle:"",fontColor:"#000000",fontSize:8},time:{xAxis:0,yAxis:0,content:"时间",fontStyle:"",fontColor:"#9f9f9f",fontSize:6},authorName:{xAxis:0,yAxis:0,content:"PHOTO BY @ ？",fontStyle:"",fontColor:"#9f9f9f",fontSize:6},brandLogo:{xAxis:0,yAxis:0,content:"default",xPosition:"center",yPosition:"center"}}}}},mounted:function(){this.getPlatform(),this.getPhotoConfigList()},methods:g(g({},(0,c.mapMutations)(["setUserInfo"])),{},{getPlatform:function(){var t=this;e.getSystemInfo({success:function(e){console.log("getSystemInfo",e),t.systemPlatform=e.platform}})},getUserInfo:function(t){var o=this;console.log(o.userInfo),o.userInfo.nickName&&(console.log(o.userInfo),t&&"function"==typeof t&&t()),e.showLoading({title:"获取用户信息",duration:15e3,mask:!0}),e.getStorage({key:"userInfo",success:function(n){var i=n.data,a=(new Date).getTime();i.expirationTime&&a<i.expirationTime?(o.userInfo=i.userInfo,t&&"function"==typeof t&&t()):o.getUserProfile(t),e.hideLoading()},fail:function(){o.getUserProfile(t),e.hideLoading()}})},getUserProfile:function(t){var o=this;e.getUserProfile({desc:"用于您的页面展示用户头像与昵称",lang:"zh_CN",success:function(n){o.userInfo=n.userInfo,e.setStorageSync("userInfo",{userInfo:n.userInfo,expirationTime:(new Date).getTime()+36e5}),t&&"function"==typeof t&&t()},fail:function(){e.setStorageSync("userInfo",{}),e.showToast({title:"获取用户失败",icon:"none"}),t&&"function"==typeof t&&t()}})},getPhotoConfigList:function(){var t=this;e.getStorage({key:"photoConfigData",success:function(e){var o=e.data,n=(new Date).getTime();o.expirationTime&&n<o.expirationTime?t.photoConfigData=o.data:t.getPhotoConfigListByWXDB()},fail:function(){t.getPhotoConfigListByWXDB()}})},getPhotoConfigListByDB:function(){var t=this,o=n.database();console.log("数据库中获取"),o.collection("photo_broder_logo_list").get().then((function(o){var n=o.result;console.log("配置加载完成");var i=n.data;i=s.default.sortBy(i,(function(e){return e.sort_key})),t.photoConfigData=i,e.setStorageSync("photoConfigData",{data:i,expirationTime:(new Date).getTime()+864e5})})).catch((function(o){t.photoConfigData=[],e.showToast({icon:"error",duration:1e3,title:"配置加载失败"})}))},getPhotoConfigListByWXDB:function(){var t=this;return f(i.default.mark((function o(){var n,a,r,c,s,l,u;return i.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return n=t,wx.cloud.init({traceUser:!0}),a=wx.cloud.database(),o.next=5,a.collection("photo_broder_logo_list").count();case 5:r=o.sent,console.log("countObj",r),c=r.total||20,s=[],l=0;case 10:if(!(l<c)){o.next=19;break}return o.next=13,a.collection("photo_broder_logo_list").skip(l).orderBy("sort_key","asc").get();case 13:u=o.sent,console.log("list",u),s=s.concat(u.data);case 16:l+=20,o.next=10;break;case 19:n.photoConfigData=s,console.log("getPhotoConfigListByWXDB list",s),e.setStorageSync("photoConfigData",{data:s,expirationTime:(new Date).getTime()+864e5});case 22:case"end":return o.stop()}}),o)})))()},onUpdatedFile:function(){var t=this;return f(i.default.mark((function o(){var n;return i.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:n=t;try{n.getUserInfo(n.chooseImage),e.hideLoading()}catch(i){console.log("getUserInfo",i),e.showToast({icon:"error",duration:1e3,title:"需要用户信息"}),e.hideLoading()}case 2:case"end":return o.stop()}}),o)})))()},chooseImage:function(){var t=this,o=this;console.log("chooseImage"),o.loading||e.chooseImage({sizeType:["original"],sourceType:["album"],count:1,success:function(){var n=f(i.default.mark((function n(a){var r;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.showLoading({title:"开始绘制",duration:15e3,mask:!0}),o.loading=!0,setTimeout((function(){t.loading=!1}),1e4),r=a.tempFilePaths[0],o.photoDrawInfo.mainImage.content=r,o.tempImage="",o.tempImageBase64="",o.initPhotoInfo(r);case 8:case"end":return n.stop()}}),n)})));function a(e){return n.apply(this,arguments)}return a}(),fail:function(){e.showToast({title:"获取图片失败",icon:"none"})}})},initPhotoInfo:function(e){var t=this;return f(i.default.mark((function o(){var n;return i.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return n=t,o.next=3,n.getCanvasSize(e);case 3:setTimeout((function(){(0,a.getImageData)(e).then((function(e){console.log("getImageData",JSON.stringify(e.exif)),n.photoExifInfo=e.exif,n.initExifCanvasInfo(e.exif),n.startDraw()})).catch((function(e){console.log("getImageData error",e),n.initExifCanvasInfo(),n.startDraw()}))}),1e3);case 4:case"end":return o.stop()}}),o)})))()},initExifCanvasInfo:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=this;console.log("initExifCanvasInfo",t),t.FNumber&&t.ExposureTime&&t.FocalLength&&t.Make&&t.Model||e.showToast({icon:"error",duration:1e3,title:"识别失败"}),this.photoDrawInfo.EXIFInfo.brandLogo.content=t.Make||"default",this.photoDrawInfo.EXIFInfo.machineName.content=t.Model||"machine name";var n=t.DateTimeOriginal;n&&n.indexOf(":")>=4&&(n=n.replace(":","-"),n=n.replace(":","-"));var i=r.default.formatTime(new Date,"yyyy-MM-dd hh:mm:ss");this.photoDrawInfo.EXIFInfo.time.content=n||i,this.photoDrawInfo.EXIFInfo.authorName.content="PHOTO BY @"+o.userInfo.nickName||!1;var a="?mm ",c="f/? ",s="?/?",l=" ISO ?";t.FocalLength&&(a=t.FocalLength+"mm "),t.FNumber&&t.FNumber.numerator&&t.FNumber.denominator&&(c="f/"+t.FNumber.numerator/t.FNumber.denominator+" "),t.ExposureTime&&t.ExposureTime.numerator&&t.ExposureTime.denominator&&(s=t.ExposureTime.numerator+"/"+t.ExposureTime.denominator),t.ISOSpeedRatings&&(l=l=" ISO"+(t.ISOSpeedRatings||" ?")),this.photoDrawInfo.EXIFInfo.imgInfo.content=a+c+s+l},resetPhotoInfo:function(t){var o=this;return f(i.default.mark((function n(){return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o.tempImage="",o.tempImageBase64="",o.loading=!0,setTimeout((function(){o.loading=!1}),1e4),o.closePopup(),o.photoDrawInfo=t,e.showLoading({title:"绘制中...",duration:6e4}),n.next=9,o.getCanvasSize(o.photoDrawInfo.mainImage.content);case 9:setTimeout((function(){o.startDraw()}),1e3);case 10:case"end":return n.stop()}}),n)})))()},startDraw:function(){var t=this;return f(i.default.mark((function o(){var n,a,r,c,s,l,u,f,h,g,m,d,p,I,w,v,x,S,b,y,D,T,C,P,z,F,k,L;return i.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return n=t,console.log("开始绘制"),e.showLoading({title:"绘制中...",duration:6e4}),a=t.photoDrawInfo,t.canvasConfig,r=a.mainImage,c=a.EXIFInfo,console.log("this.photoDrawInfo",JSON.stringify(t.photoDrawInfo)),s=e.createCanvasContext("canvas"),console.log("cavans宽高：",a.width,a.height),s.width=a.width,s.height=a.height,s.clearRect(0,0,a.width,a.height),s.setFillStyle(a.background),s.fillRect(0,0,a.width,a.height),s.drawImage(r.content,r.xAxis,r.yAxis,r.width,r.height),l=n.calculationScaleSize(8),u=n.calculationScaleSize(0),f=n.calculationScaleSize(15),h=n.calculationScaleSize(3),g="gilmerRegular",m=n.calculationScaleSize(5),d=l+n.calculationScaleSize(c.machineName.xAxis),p=u+r.originHeight+h,t.drawText(s,c.machineName.content,n.calculationScaleSize(c.machineName.fontSize),c.machineName.fontColor,d,p,5e3,!0,"",g),I=l+n.calculationScaleSize(c.authorName.xAxis),w=u+n.calculationScaleSize(c.authorName.yAxis)+r.originHeight+f,t.drawText(s,c.authorName.content,n.calculationScaleSize(c.authorName.fontSize),c.authorName.fontColor,I,w,5e3,!1,"",g),o.next=28,t.getTextWidth(s,c.time.content,!0,n.calculationScaleSize(c.time.fontSize),g);case 28:return v=o.sent,o.next=31,t.getTextWidth(s,c.imgInfo.content,!1,n.calculationScaleSize(c.imgInfo.fontSize),g);case 31:x=o.sent,S=v>=x?v:x,console.log("rightWidth",S,r.width),b=r.originWidth-l-S+n.calculationScaleSize(c.imgInfo.xAxis),y=u+n.calculationScaleSize(c.imgInfo.yAxis)+r.originHeight+h,t.drawText(s,c.imgInfo.content,n.calculationScaleSize(c.imgInfo.fontSize),c.imgInfo.fontColor,b,y,5e3,!0,"",g),D=r.originWidth-l-S+n.calculationScaleSize(c.time.xAxis),T=u+n.calculationScaleSize(c.time.yAxis)+r.originHeight+f,t.drawText(s,c.time.content,n.calculationScaleSize(c.time.fontSize),c.time.fontColor,D,T,5e3,!1,"",g),C=(c.InfoWrapperHeight+n.calculationScaleSize(c.time.fontSize)+n.calculationScaleSize(c.imgInfo.fontSize))/2,P=r.originWidth-l-S-m,z=r.originHeight+(c.InfoWrapperHeight-C)/2,s.moveTo(P,z),s.lineTo(P,C+z),s.strokeStyle=c.color,s.lineWidth=n.calculationScaleSize(.3),s.stroke(),F="",k="",L=0;case 51:if(!(L<t.photoConfigData.length)){o.next=60;break}if("default"==t.photoConfigData[L].photo_keyword&&(k=t.photoConfigData[L].photo_url),!t.photoDrawInfo.EXIFInfo.brandLogo.content||!(t.photoDrawInfo.EXIFInfo.brandLogo.content.toLowerCase().indexOf(t.photoConfigData[L].photo_keyword.toLowerCase())>=0||t.photoConfigData[L].photo_keyword.toLowerCase().indexOf(t.photoDrawInfo.EXIFInfo.brandLogo.content.toLowerCase())>=0)){o.next=57;break}return console.log("setLogo"),F=t.photoConfigData[L].photo_url,o.abrupt("break",60);case 57:L++,o.next=51;break;case 60:F&&""!=F?F&&""!=F||k&&""!=k||(F=t.defaultLogo):F=k,console.log("logoImg",F,C),e.getImageInfo({src:F,success:function(t){console.log("logo width",t.width),console.log("logo height",t.height);var o=C/2;t.width/2.3>t.height&&(o=C/3);var i=n.calculationImageScaleSize({width:t.width,height:t.height},o,"height"),a=r.originWidth-l-S-2*m-i.width,u=r.originHeight+(c.InfoWrapperHeight-o)/2;s.drawImage(t.path,a,u,i.width,i.height),s.draw(!1,(function(){n.saveTempImage()})),console.log("结束绘制"),e.hideLoading()},fail:function(){s.draw(!1,(function(){n.saveTempImage()})),console.log("结束绘制"),e.hideLoading()}});case 63:case"end":return o.stop()}}),o)})))()},drawText:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#000",i=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:999,c=arguments.length>7?arguments[7]:void 0,s=arguments.length>8?arguments[8]:void 0,l=arguments.length>9?arguments[9]:void 0;if(e.font=c?"bold ".concat(o,"px ").concat(l||"normal"):"normal ".concat(o,"px  ").concat(l||"normal"),e.textAlign=s||"left",e.fillStyle=n,e.textBaseline="middle",console.log("drawText",o,Number(a)+Number(o)),e.measureText(t).width>r){var u=1;while(e.measureText(t.slice(0,t.length-u)).width>693)u++;e.fillText(t.slice(0,t.length-(u+1))+"...",i,Number(a)+Number(o))}else e.fillText(t,i,Number(a)+Number(o))},getCanvasSize:function(){var t=arguments,o=this;return f(i.default.mark((function n(){var a,c;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=t.length>0&&void 0!==t[0]?t[0]:"",c=o,""!=a){n.next=4;break}throw"文件格式错误";case 4:return n.prev=4,n.next=7,e.getImageInfo({src:a,success:function(e){console.log("width",e.width),console.log("height",e.height);var t=e.width,o=e.height;e.width>3e3?(t=3e3,o=r.default.formatNumber(r.default.formatDecimal(e.height/e.width*3e3,2))):e.height>3e3&&(o=3e3,t=r.default.formatNumber(r.default.formatDecimal(e.width/e.height*3e3,2))),c.photoDrawInfo.width=t;var n=r.default.formatNumber(r.default.formatDecimal(320/t,5));c.canvasConfig.scale=n,c.showQuality=n;var i=c.calculationScaleSize(c.canvasConfig.maxCanvasInfoWrapperSize,c.canvasConfig.scale);c.photoDrawInfo.EXIFInfo.InfoWrapperHeight=i,c.photoDrawInfo.height=o+i,c.getImageSize(t,o)}});case 7:n.next=12;break;case 9:n.prev=9,n.t0=n["catch"](4),console.log("error",n.t0);case 12:case"end":return n.stop()}}),n,null,[[4,9]])})))()},calculationImageScaleSize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"width",n=e.width,i=e.height;return"width"==o?(n=t,i=r.default.formatNumber(r.default.formatDecimal(e.height/e.width*t,2))):(i=t,n=r.default.formatNumber(r.default.formatDecimal(e.width/e.height*t,2))),{width:n,height:i}},calculationScaleSize:function(e,t){var o=t;return o&&""!=o||(o=this.canvasConfig.scale),r.default.formatNumber(r.default.formatDecimal(e/o,0))},getImageSize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=s.default.cloneDeep(this.photoDrawInfo);e&&t&&(o.mainImage.originWidth=e,o.mainImage.originHeight=t);var n=o.mainImage.originWidth,i=o.mainImage.originHeight;if(o.mainImage.width=o.mainImage.scale*o.mainImage.originWidth,o.mainImage.height=o.mainImage.scale*o.mainImage.originHeight,o.mainImage.xAxis=0,o.mainImage.yAxis=0,!o.mainImage.customXAxis&&!o.mainImage.customXAxis){var a=(n-o.mainImage.width)/2,r=(i-o.mainImage.height)/2,c=a>=r?a:r;"left"==o.mainImage.position?(o.mainImage.yAxis=c,o.mainImage.xAxis=0):"right"==o.mainImage.position?(o.mainImage.yAxis=c,o.mainImage.xAxis=2*c):"top"==o.mainImage.position?(o.mainImage.yAxis=0,o.mainImage.xAxis=c):"bottom"==o.mainImage.position?(o.mainImage.yAxis=2*c,o.mainImage.xAxis=c):(o.mainImage.yAxis=c,o.mainImage.xAxis=c);var l=Math.abs(a-r);a>r?(o.height+=2*l,o.mainImage.originHeight+=2*l):(o.width+=2*l,o.mainImage.originWidth+=2*l)}o.mainImage.angle=o.mainImage.customAngle,this.photoDrawInfo=o,console.log("photoDrawInfo",JSON.stringify(o))},getTextWidth:function(e,t,o){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:12,i=arguments.length>4?arguments[4]:void 0;return e.font=o?"bold ".concat(n,"px ").concat(i||"normal"):"normal ".concat(n,"px  ").concat(i||"normal"),e.measureText(t).width},saveImage:function(){var t=this;t.photoDrawInfo.mainImage.content&&""!=t.photoDrawInfo.mainImage.content?t.downloadImage():e.showModal({title:"提示",content:"需要先上传图片",success:function(e){e.confirm&&t.onUpdatedFile()}})},saveTempImage:function(){var t=this;console.log("saveTempImage");var o=this,n=this.photoDrawInfo;e.showLoading({title:"生成中...",duration:6e3,mask:!0});var i=r.default.formatNumber(r.default.formatDecimal(n.compress/100,2));console.log(" photoDrawInfo.width * compressTime * this.showQuality",n.width*i*this.showQuality),e.canvasToTempFilePath({x:0,y:0,width:n.width,height:n.height,destWidth:n.width*i,destHeight:n.height*i,canvasId:"canvas",success:function(a){o.tempImage=a.tempFilePath,e.canvasToTempFilePath({x:0,y:0,width:n.width,height:n.height,destWidth:n.width*i,destHeight:n.height*i,canvasId:"canvas",fileType:"jpg",quality:t.showQuality,success:function(t){try{e.getFileSystemManager().readFile({filePath:t.tempFilePath,encoding:"base64",success:function(e){var t="data:image/jpeg;base64,"+e.data;o.tempImageBase64=t}})}catch(n){console.log("urlTobase64",n)}},fail:function(t){console.log(t),o.loading=!1,e.hideLoading()}},o)},fail:function(t){console.log(t),o.loading=!1,e.hideLoading()}},o)},downloadImage:function(){var t=this,o=this.photoDrawInfo,n=r.default.formatNumber(r.default.formatDecimal(o.compress/100,2));o.width*n>3e3||o.height*n>3e3?e.showLoading({title:"文件较大，下载中...",duration:6e4,mask:!0}):e.showLoading({title:"下载中...",duration:15e3,mask:!0}),e.saveImageToPhotosAlbum({filePath:t.tempImage,success:function(){e.hideLoading(),e.showToast({title:"图片已保存图片到相册",icon:"none",duration:2e3})},fail:function(){e.hideLoading(),e.showToast({title:"保存失败，请打权限功能重试",icon:"none"})}}),t.loading=!1,e.hideLoading()},closePopup:function(){this.showForm=!1},openPopup:function(){var t=this;t.photoDrawInfo.mainImage.content&&""!=t.photoDrawInfo.mainImage.content?t.showForm=!0:e.showModal({title:"提示",content:"需要先上传图片",success:function(e){e.confirm&&t.onUpdatedFile()}})}})};t.default=p}).call(this,o(1)["default"],o(151)["default"])},156:function(e,t,o){"use strict";o.r(t);var n=o(157),i=o.n(n);for(var a in n)"default"!==a&&function(e){o.d(t,e,(function(){return n[e]}))}(a);t["default"]=i.a},157:function(e,t,o){}},[[145,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../../.sourcemap/mp-weixin/pages/componentsFunction/photoBorder/photoBorder.js.map